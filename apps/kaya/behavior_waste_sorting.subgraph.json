{
  "modules": [
    "//packages/kaya_misc:kaya",
    "navigation",
    "planner",
    "utils"
  ],
  "graph": {
    "nodes": [
      {
        "name": "subgraph",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "interface",
            "type": "isaac::alice::Subgraph"
          }
        ]
      },
      {
        "name": "lqr",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.planner.HolonomicBaseLqrPlanner",
            "type": "isaac::planner::HolonomicBaseLqrPlanner"
          }
        ]
      },
      {
        "name": "goal_to_plan",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.kaya.GoalToPlan",
            "type": "isaac::kaya::GoalToPlan"
          }
        ]
      },
      {
        "name": "goal_viewer",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.viewers.GoalViewer",
            "type": "isaac::viewers::GoalViewer"
          }
        ]
      },
      {
        "name": "behavior_find_and_sort_a_waste",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.MemorySequenceBehavior",
            "type": "isaac::alice::behaviors::MemorySequenceBehavior"
          }
        ]
      },
      {
        "name": "behavior_look_for_object",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.ParallelBehavior",
            "type": "isaac::alice::behaviors::ParallelBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_wait_for_yolo_and_rotate_at_center",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.MemorySequenceBehavior",
            "type": "isaac::alice::behaviors::MemorySequenceBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_rotate_at_center",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.MemorySequenceBehavior",
            "type": "isaac::alice::behaviors::MemorySequenceBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_go_to_center",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.ParallelBehavior",
            "type": "isaac::alice::behaviors::ParallelBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_approach_object",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.ParallelBehavior",
            "type": "isaac::alice::behaviors::ParallelBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_push_object",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.ParallelBehavior",
            "type": "isaac::alice::behaviors::ParallelBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_back_up",
        "components": [
          {
            "name": "isaac.alice.behaviors.NodeGroup",
            "type": "isaac::alice::behaviors::NodeGroup"
          },
          {
            "name": "isaac.alice.behaviors.ParallelBehavior",
            "type": "isaac::alice::behaviors::ParallelBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_timer_yolo_start",
        "components": [
          {
            "name": "isaac.alice.behaviors.TimerBehavior",
            "type": "isaac::alice::behaviors::TimerBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "behavior_timer_back_up",
        "components": [
          {
            "name": "isaac.alice.behaviors.TimerBehavior",
            "type": "isaac::alice::behaviors::TimerBehavior"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "command_back_up",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.kaya.HolonomicBaseCommand",
            "type": "isaac::kaya::HolonomicBaseCommand"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "command_rotate_around",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.kaya.HolonomicBaseCommand",
            "type": "isaac::kaya::HolonomicBaseCommand"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "wait_until_detection",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "WaitUntilDetection",
            "type": "isaac::utils::WaitUntilDetection"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "waypoint_as_goal_center",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.navigation.MapWaypointAsGoal",
            "type": "isaac::navigation::MapWaypointAsGoal"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "control_center",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.planner.HolonomicBaseControl",
            "type": "isaac::planner::HolonomicBaseControl"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "go_to_center",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.navigation.GoTo",
            "type": "isaac::navigation::GoTo"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "approach_object",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.kaya.ApproachObject",
            "type": "isaac::kaya::ApproachObject"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "control_approach",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.planner.HolonomicBaseControl",
            "type": "isaac::planner::HolonomicBaseControl"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "go_to_approach",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.navigation.GoTo",
            "type": "isaac::navigation::GoTo"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "waypoint_as_goal_push",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.navigation.MapWaypointAsGoal",
            "type": "isaac::navigation::MapWaypointAsGoal"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "control_push",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.planner.HolonomicBaseControl",
            "type": "isaac::planner::HolonomicBaseControl"
          }
        ],
        "disable_automatic_start": true
      },
      {
        "name": "go_to_push",
        "components": [
          {
            "name": "message_ledger",
            "type": "isaac::alice::MessageLedger"
          },
          {
            "name": "isaac.navigation.GoTo",
            "type": "isaac::navigation::GoTo"
          }
        ],
        "disable_automatic_start": true
      }
    ],
    "edges": [
      {
        "source": "command_rotate_around/isaac.kaya.HolonomicBaseCommand/command",
        "target": "subgraph/interface/command"
      },
      {
        "source": "subgraph/interface/detections",
        "target": "wait_until_detection/WaitUntilDetection/detections"
      },
      {
        "source": "goal_to_plan/isaac.kaya.GoalToPlan/plan",
        "target": "lqr/isaac.planner.HolonomicBaseLqrPlanner/global_plan"
      },
      {
        "source": "waypoint_as_goal_center/isaac.navigation.MapWaypointAsGoal/goal",
        "target": "goal_to_plan/isaac.kaya.GoalToPlan/goal"
      },
      {
        "source": "waypoint_as_goal_center/isaac.navigation.MapWaypointAsGoal/goal",
        "target": "goal_viewer/isaac.viewers.GoalViewer/goal"
      },
      {
        "source": "waypoint_as_goal_push/isaac.navigation.MapWaypointAsGoal/goal",
        "target": "goal_viewer/isaac.viewers.GoalViewer/goal"
      },
      {
        "source": "approach_object/isaac.kaya.ApproachObject/goal",
        "target": "goal_viewer/isaac.viewers.GoalViewer/goal"
      },
      {
        "source": "waypoint_as_goal_center/isaac.navigation.MapWaypointAsGoal/goal",
        "target": "go_to_center/isaac.navigation.GoTo/goal_in"
      },
      {
        "source": "waypoint_as_goal_push/isaac.navigation.MapWaypointAsGoal/goal",
        "target": "goal_to_plan/isaac.kaya.GoalToPlan/goal"
      },
      {
        "source": "waypoint_as_goal_push/isaac.navigation.MapWaypointAsGoal/goal",
        "target": "go_to_push/isaac.navigation.GoTo/goal_in"
      },
      {
        "source": "approach_object/isaac.kaya.ApproachObject/goal",
        "target": "go_to_approach/isaac.navigation.GoTo/goal_in"
      },
      {
        "source": "approach_object/isaac.kaya.ApproachObject/object_label",
        "target": "waypoint_as_goal_push/isaac.navigation.MapWaypointAsGoal/desired_waypoint"
      },
      {
        "source": "approach_object/isaac.kaya.ApproachObject/plan",
        "target": "lqr/isaac.planner.HolonomicBaseLqrPlanner/global_plan"
      },
      {
        "source": "command_back_up/isaac.kaya.HolonomicBaseCommand/command",
        "target": "subgraph/interface/command"
      },
      {
        "source": "lqr/isaac.planner.HolonomicBaseLqrPlanner/plan",
        "target": "control_center/isaac.planner.HolonomicBaseControl/plan"
      },
      {
        "source": "control_center/isaac.planner.HolonomicBaseControl/cmd",
        "target": "subgraph/interface/command"
      },
      {
        "source": "lqr/isaac.planner.HolonomicBaseLqrPlanner/plan",
        "target": "control_push/isaac.planner.HolonomicBaseControl/plan"
      },
      {
        "source": "control_push/isaac.planner.HolonomicBaseControl/cmd",
        "target": "subgraph/interface/command"
      },
      {
        "source": "lqr/isaac.planner.HolonomicBaseLqrPlanner/plan",
        "target": "control_approach/isaac.planner.HolonomicBaseControl/plan"
      },
      {
        "source": "control_approach/isaac.planner.HolonomicBaseControl/cmd",
        "target": "subgraph/interface/command"
      },
      {
        "source": "subgraph/interface/detections_with_poses",
        "target": "approach_object/isaac.kaya.ApproachObject/detections"
      },
      {
        "source": "subgraph/interface/odometry",
        "target": "lqr/isaac.planner.HolonomicBaseLqrPlanner/odometry"
      }
    ]
  },
  "config": {
    "lqr": {
      "isaac.planner.HolonomicBaseLqrPlanner": {
        "max_speed": 0.25,
        "num_controls": 50,
        "min_distance": 0.01,
        "target_distance": 0.02,
        "gain_to_end_position_x": 20.0,
        "gain_to_end_position_y": 20.0,
        "gain_to_end_angle": 5.0,
        "gain_angular_acceleration": 0.2,
        "gain_lat_acceleration": 2.5,
        "gain_linear_acceleration": 2.5,
        "tick_period": "10Hz"
      }
    },
    "approach_object": {
      "isaac.kaya.ApproachObject": {
        "distance_to_object": 0.05,
        "min_distance_to_wall": 0.04,
        "additional_detour_distance": 0.03
      }
    },
    "behavior_find_and_sort_a_waste": {
      "isaac.alice.behaviors.MemorySequenceBehavior": {
        "tick_period": "10Hz"
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname behavior_look_for_object)",
          "$(fullname behavior_approach_object)",
          "$(fullname behavior_push_object)",
          "$(fullname behavior_back_up)"
        ],
        "tick_period": "10Hz"
      }
    },
    "behavior_look_for_object": {
      "isaac.alice.behaviors.ParallelBehavior": {
        "success_threshold": 1
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname wait_until_detection)",
          "$(fullname behavior_wait_for_yolo_and_rotate_at_center)"
        ]
      }
    },
    "behavior_wait_for_yolo_and_rotate_at_center": {
      "isaac.alice.behaviors.MemorySequenceBehavior": {
        "tick_period": "10Hz"
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname behavior_timer_yolo_start)",
          "$(fullname behavior_rotate_at_center)"
        ],
        "tick_period": "10Hz"
      }
    },
    "behavior_timer_yolo_start": {
      "isaac.alice.behaviors.TimerBehavior": {
        "delay": 10.0
      }
    },
    "behavior_rotate_at_center": {
      "isaac.alice.behaviors.MemorySequenceBehavior": {
        "tick_period": "10Hz"
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname behavior_go_to_center)",
          "$(fullname command_rotate_around)"
        ],
        "tick_period": "10Hz"
      }
    },
    "behavior_go_to_center": {
      "isaac.alice.behaviors.ParallelBehavior": {
        "success_threshold": 1
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname waypoint_as_goal_center)",
          "$(fullname control_center)",
          "$(fullname go_to_center)"
        ]
      }
    },
    "behavior_approach_object": {
      "isaac.alice.behaviors.ParallelBehavior": {
        "success_threshold": 1
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname approach_object)",
          "$(fullname control_approach)",
          "$(fullname go_to_approach)"
        ]
      }
    },
    "behavior_push_object": {
      "isaac.alice.behaviors.ParallelBehavior": {
        "success_threshold": 1
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname waypoint_as_goal_push)",
          "$(fullname control_push)",
          "$(fullname go_to_push)"
        ]
      }
    },
    "behavior_back_up": {
      "isaac.alice.behaviors.ParallelBehavior": {
        "success_threshold": 1
      },
      "isaac.alice.behaviors.NodeGroup": {
        "node_names": [
          "$(fullname behavior_timer_back_up)",
          "$(fullname command_back_up)"
        ]
      }
    },
    "behavior_timer_back_up": {
      "isaac.alice.behaviors.TimerBehavior": {
        "delay": 1.0
      }
    },
    "command_back_up": {
      "isaac.kaya.HolonomicBaseCommand": {
        "tick_period": "10ms",
        "speed_angular": 0.0,
        "speed_linear_x": -0.4,
        "speed_linear_y": 0.0
      }
    },
    "command_rotate_around": {
      "isaac.kaya.HolonomicBaseCommand": {
        "tick_period": "10ms",
        "speed_angular": 1.0,
        "speed_linear_x": 0.0,
        "speed_linear_y": 0.0
      }
    },
    "control_center": {
      "isaac.planner.HolonomicBaseControl": {
        "manual_mode_channel": "commander.robot_remote/isaac.navigation.RobotRemoteControl/manual_mode",
        "use_tick_time": true,
        "tick_period": "100Hz"
      }
    },
    "go_to_center": {
      "isaac.navigation.GoTo": {
        "var_rx_speed_pos": "odometry.odometry/HolonomicBaseWheelImuOdometry/speed_p",
        "var_rx_speed_rot": "odometry.odometry/HolonomicBaseWheelImuOdometry/speed_q",
        "report_success": true,
        "tick_period": "50ms",
        "arrived_position_thresholds": [
          0.05,
          0.1
        ]
      }
    },
    "waypoint_as_goal_center": {
      "isaac.navigation.MapWaypointAsGoal": {
        "waypoint": "center",
        "map_layer": "map/waypoints",
        "tick_period": "50ms"
      }
    },
    "control_approach": {
      "isaac.planner.HolonomicBaseControl": {
        "manual_mode_channel": "commander.robot_remote/isaac.navigation.RobotRemoteControl/manual_mode",
        "use_tick_time": true,
        "tick_period": "100Hz"
      }
    },
    "go_to_approach": {
      "isaac.navigation.GoTo": {
        "var_rx_speed_pos": "odometry.odometry/HolonomicBaseWheelImuOdometry/speed_p",
        "var_rx_speed_rot": "odometry.odometry/HolonomicBaseWheelImuOdometry/speed_q",
        "report_success": true,
        "tick_period": "50ms",
        "arrived_position_thresholds": [
          0.03,
          0.1
        ]
      }
    },
    "waypoint_as_goal_push": {
      "isaac.navigation.MapWaypointAsGoal": {
        "map_layer": "map/waypoints",
        "tick_period": "50ms"
      }
    },
    "control_push": {
      "isaac.planner.HolonomicBaseControl": {
        "manual_mode_channel": "commander.robot_remote/isaac.navigation.RobotRemoteControl/manual_mode",
        "use_tick_time": true,
        "tick_period": "100Hz"
      }
    },
    "go_to_push": {
      "isaac.navigation.GoTo": {
        "var_rx_speed_pos": "odometry.odometry/HolonomicBaseWheelImuOdometry/speed_p",
        "var_rx_speed_rot": "odometry.odometry/HolonomicBaseWheelImuOdometry/speed_q",
        "report_success": true,
        "tick_period": "50ms",
        "arrived_position_thresholds": [
          0.02,
          0.07
        ]
      }
    }
  }
}
